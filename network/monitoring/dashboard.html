<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medical Blockchain Monitoring Dashboard</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            min-height: 100vh;
        }

        .dashboard {
            display: grid;
            grid-template-columns: 250px 1fr;
            min-height: 100vh;
        }

        .sidebar {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 2rem 1rem;
            border-right: 1px solid rgba(255, 255, 255, 0.2);
        }

        .sidebar h2 {
            color: white;
            margin-bottom: 2rem;
            font-size: 1.5rem;
        }

        .nav-item {
            display: block;
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            padding: 1rem;
            margin-bottom: 0.5rem;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .nav-item:hover,
        .nav-item.active {
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }

        .main-content {
            padding: 2rem;
            overflow-y: auto;
        }

        .header {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 1.5rem 2rem;
            border-radius: 15px;
            margin-bottom: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .header h1 {
            color: white;
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .header .status {
            color: rgba(255, 255, 255, 0.8);
            font-size: 1rem;
        }

        .status-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .status-active {
            background: #4CAF50;
        }

        .status-warning {
            background: #FF9800;
        }

        .status-error {
            background: #F44336;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .metric-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 1.5rem;
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            text-align: center;
        }

        .metric-card h3 {
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .metric-card .value {
            color: white;
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .metric-card .change {
            font-size: 0.8rem;
            padding: 0.25rem 0.5rem;
            border-radius: 12px;
        }

        .change.positive {
            background: rgba(76, 175, 80, 0.2);
            color: #4CAF50;
        }

        .change.negative {
            background: rgba(244, 67, 54, 0.2);
            color: #F44336;
        }

        .charts-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .chart-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 1.5rem;
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .chart-card h3 {
            color: white;
            margin-bottom: 1rem;
            font-size: 1.2rem;
        }

        .alerts-section {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 1.5rem;
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .alerts-section h3 {
            color: white;
            margin-bottom: 1rem;
            font-size: 1.2rem;
        }

        .alert-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 0.5rem;
            border-left: 4px solid;
        }

        .alert-high {
            border-left-color: #F44336;
        }

        .alert-medium {
            border-left-color: #FF9800;
        }

        .alert-low {
            border-left-color: #4CAF50;
        }

        .alert-item .alert-title {
            color: white;
            font-weight: bold;
            margin-bottom: 0.25rem;
        }

        .alert-item .alert-time {
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.8rem;
        }

        .real-time-log {
            background: rgba(0, 0, 0, 0.3);
            padding: 1rem;
            border-radius: 8px;
            height: 200px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.8rem;
        }

        .log-entry {
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 0.25rem;
        }

        .log-entry.error {
            color: #F44336;
        }

        .log-entry.warning {
            color: #FF9800;
        }

        .log-entry.success {
            color: #4CAF50;
        }

        @media (max-width: 768px) {
            .dashboard {
                grid-template-columns: 1fr;
            }

            .sidebar {
                display: none;
            }

            .charts-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body>
    <div class="dashboard">
        <div class="sidebar">
            <h2>üè• MedChain</h2>
            <a href="#overview" class="nav-item active">üìä Overview</a>
            <a href="#transactions" class="nav-item">üí≥ Transactions</a>
            <a href="#channels" class="nav-item">üîó Channels</a>
            <a href="#security" class="nav-item">üîí Security</a>
            <a href="#compliance" class="nav-item">üìã Compliance</a>
            <a href="#alerts" class="nav-item">‚ö†Ô∏è Alerts</a>
        </div>

        <div class="main-content">
            <div class="header">
                <h1>Medical Blockchain Network Status</h1>
                <div class="status">
                    <span class="status-indicator status-active"></span>
                    Network Active ‚Ä¢ <span id="current-time">Loading...</span>
                </div>
            </div>

            <div class="metrics-grid">
                <div class="metric-card">
                    <h3>Total Transactions</h3>
                    <div class="value" id="total-transactions">1,247</div>
                    <div class="change positive">+12% today</div>
                </div>

                <div class="metric-card">
                    <h3>Active Channels</h3>
                    <div class="value" id="active-channels">3</div>
                    <div class="change positive">All healthy</div>
                </div>

                <div class="metric-card">
                    <h3>Data Accesses</h3>
                    <div class="value" id="data-accesses">89</div>
                    <div class="change positive">+5% today</div>
                </div>

                <div class="metric-card">
                    <h3>Security Alerts</h3>
                    <div class="value" id="security-alerts">2</div>
                    <div class="change negative">2 active</div>
                </div>
            </div>

            <div class="charts-grid">
                <div class="chart-card">
                    <h3>Transaction Volume (Last 24 Hours)</h3>
                    <canvas id="transactionChart" width="400" height="200"></canvas>
                </div>

                <div class="chart-card">
                    <h3>Channel Activity</h3>
                    <canvas id="channelChart" width="200" height="200"></canvas>
                </div>
            </div>

            <div class="alerts-section">
                <h3>Recent Security Alerts</h3>
                <div id="alerts-container">
                    <div class="alert-item alert-high">
                        <div class="alert-title">Multiple Failed Access Attempts</div>
                        <div class="alert-time">User ID: insurance_user_001 ‚Ä¢ 5 minutes ago</div>
                    </div>
                    <div class="alert-item alert-medium">
                        <div class="alert-title">Off-Hours Data Access</div>
                        <div class="alert-time">User ID: hospital_admin_003 ‚Ä¢ 15 minutes ago</div>
                    </div>
                </div>

                <h3 style="margin-top: 1.5rem;">Real-time Activity Log</h3>
                <div class="real-time-log" id="activity-log">
                    <div class="log-entry">[2024-01-20 14:30:15] Block #1247 added to medical-channel</div>
                    <div class="log-entry success">[2024-01-20 14:30:12] Consent granted for patient P-12345</div>
                    <div class="log-entry">[2024-01-20 14:30:08] Data access request processed</div>
                    <div class="log-entry warning">[2024-01-20 14:29:58] Unusual access pattern detected</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Real-time dashboard functionality
        class MedicalBlockchainDashboard {
            constructor() {
                this.socket = null;
                this.charts = {};
                this.metrics = {
                    totalTransactions: 1247,
                    activeChannels: 3,
                    dataAccesses: 89,
                    securityAlerts: 2
                };
                this.init();
            }

            init() {
                this.updateCurrentTime();
                this.initializeCharts();
                this.connectWebSocket();
                this.setupEventListeners();

                // Update time every second
                setInterval(() => this.updateCurrentTime(), 1000);

                // Simulate real-time updates for demo
                this.startSimulation();
            }

            updateCurrentTime() {
                const now = new Date();
                document.getElementById('current-time').textContent =
                    now.toLocaleString('en-US', {
                        month: 'short',
                        day: 'numeric',
                        hour: '2-digit',
                        minute: '2-digit',
                        second: '2-digit'
                    });
            }

            initializeCharts() {
                // Transaction volume chart
                const txCtx = document.getElementById('transactionChart').getContext('2d');
                this.charts.transactions = new Chart(txCtx, {
                    type: 'line',
                    data: {
                        labels: Array.from({ length: 24 }, (_, i) => `${i}:00`),
                        datasets: [{
                            label: 'Transactions',
                            data: this.generateTransactionData(),
                            borderColor: 'rgba(255, 255, 255, 0.8)',
                            backgroundColor: 'rgba(255, 255, 255, 0.1)',
                            fill: true,
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                labels: { color: 'white' }
                            }
                        },
                        scales: {
                            x: {
                                ticks: { color: 'rgba(255, 255, 255, 0.8)' },
                                grid: { color: 'rgba(255, 255, 255, 0.1)' }
                            },
                            y: {
                                ticks: { color: 'rgba(255, 255, 255, 0.8)' },
                                grid: { color: 'rgba(255, 255, 255, 0.1)' }
                            }
                        },
                        interaction: {
                            intersect: false,
                            mode: 'index'
                        }
                    }
                });

                // Channel activity chart
                const channelCtx = document.getElementById('channelChart').getContext('2d');
                this.charts.channels = new Chart(channelCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Medical Channel', 'Private Data', 'Insurance'],
                        datasets: [{
                            data: [45, 30, 25],
                            backgroundColor: [
                                'rgba(76, 175, 80, 0.8)',
                                'rgba(33, 150, 243, 0.8)',
                                'rgba(255, 152, 0, 0.8)'
                            ],
                            borderColor: [
                                'rgba(76, 175, 80, 1)',
                                'rgba(33, 150, 243, 1)',
                                'rgba(255, 152, 0, 1)'
                            ],
                            borderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    color: 'white',
                                    padding: 20
                                }
                            }
                        }
                    }
                });
            }

            generateTransactionData() {
                // Generate realistic transaction data for 24 hours
                const data = [];
                for (let i = 0; i < 24; i++) {
                    // Lower activity during night hours (0-6, 22-24)
                    let baseValue = 30;
                    if (i >= 6 && i <= 22) {
                        baseValue = 80;
                    }
                    if (i >= 9 && i <= 17) {
                        baseValue = 120; // Peak hours
                    }

                    const randomVariation = Math.random() * 40 - 20;
                    data.push(Math.max(0, baseValue + randomVariation));
                }
                return data;
            }

            connectWebSocket() {
                // In a real implementation, this would connect to your backend
                console.log('WebSocket connection would be established here');

                // Simulate connection for demo
                setTimeout(() => {
                    this.addLogEntry('WebSocket connected to blockchain monitor', 'success');
                }, 1000);
            }

            setupEventListeners() {
                // Navigation
                document.querySelectorAll('.nav-item').forEach(item => {
                    item.addEventListener('click', (e) => {
                        e.preventDefault();

                        // Remove active class from all items
                        document.querySelectorAll('.nav-item').forEach(nav => {
                            nav.classList.remove('active');
                        });

                        // Add active class to clicked item
                        item.classList.add('active');

                        this.addLogEntry(`Navigated to ${item.textContent.trim()}`, 'info');
                    });
                });
            }

            startSimulation() {
                // Simulate real-time blockchain events
                setInterval(() => {
                    this.simulateBlockchainEvent();
                }, 3000);

                setInterval(() => {
                    this.updateMetrics();
                }, 5000);

                setInterval(() => {
                    this.simulateSecurityEvent();
                }, 15000);
            }

            simulateBlockchainEvent() {
                const events = [
                    { type: 'block', message: 'New block added to medical-channel', level: 'info' },
                    { type: 'transaction', message: 'Consent transaction processed', level: 'success' },
                    { type: 'access', message: 'Patient data accessed', level: 'info' },
                    { type: 'contract', message: 'Smart contract executed successfully', level: 'success' }
                ];

                const event = events[Math.floor(Math.random() * events.length)];
                const blockNumber = Math.floor(Math.random() * 1000) + 1000;

                let message = event.message;
                if (event.type === 'block') {
                    message = `Block #${blockNumber} added to medical-channel`;
                }

                this.addLogEntry(message, event.level);

                // Update transaction count
                if (event.type === 'transaction') {
                    this.metrics.totalTransactions++;
                    document.getElementById('total-transactions').textContent =
                        this.metrics.totalTransactions.toLocaleString();
                }
            }

            simulateSecurityEvent() {
                const securityEvents = [
                    'Unusual access pattern detected',
                    'Multiple login attempts from new IP',
                    'Off-hours data access logged',
                    'Large data export request processed',
                    'Emergency access protocol activated'
                ];

                const event = securityEvents[Math.floor(Math.random() * securityEvents.length)];
                this.addLogEntry(event, 'warning');

                // Sometimes add a security alert
                if (Math.random() < 0.3) {
                    this.addSecurityAlert(event);
                }
            }

            addSecurityAlert(message) {
                const alertsContainer = document.getElementById('alerts-container');
                const severity = ['high', 'medium', 'low'][Math.floor(Math.random() * 3)];

                const alertDiv = document.createElement('div');
                alertDiv.className = `alert-item alert-${severity}`;
                alertDiv.innerHTML = `
                    <div class="alert-title">${message}</div>
                    <div class="alert-time">User ID: ${this.generateUserId()} ‚Ä¢ Just now</div>
                `;

                // Insert at the beginning
                alertsContainer.insertBefore(alertDiv, alertsContainer.firstChild);

                // Keep only last 5 alerts
                while (alertsContainer.children.length > 5) {
                    alertsContainer.removeChild(alertsContainer.lastChild);
                }

                // Update security alerts count
                this.metrics.securityAlerts++;
                document.getElementById('security-alerts').textContent = this.metrics.securityAlerts;
            }

            generateUserId() {
                const prefixes = ['hospital_admin_', 'insurance_user_', 'regulatory_audit_'];
                const prefix = prefixes[Math.floor(Math.random() * prefixes.length)];
                const number = String(Math.floor(Math.random() * 999) + 1).padStart(3, '0');
                return prefix + number;
            }

            updateMetrics() {
                // Simulate metric updates
                this.metrics.dataAccesses += Math.floor(Math.random() * 5);
                document.getElementById('data-accesses').textContent = this.metrics.dataAccesses;

                // Update charts with new data
                this.updateTransactionChart();
            }

            updateTransactionChart() {
                const chart = this.charts.transactions;
                const newData = this.generateTransactionData();
                chart.data.datasets[0].data = newData;
                chart.update('none'); // No animation for real-time updates
            }

            addLogEntry(message, level = 'info') {
                const logContainer = document.getElementById('activity-log');
                const timestamp = new Date().toLocaleString('en-US', {
                    year: 'numeric',
                    month: '2-digit',
                    day: '2-digit',
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit'
                });

                const logEntry = document.createElement('div');
                logEntry.className = `log-entry ${level}`;
                logEntry.textContent = `[${timestamp}] ${message}`;

                // Insert at the beginning
                logContainer.insertBefore(logEntry, logContainer.firstChild);

                // Keep only last 20 entries
                while (logContainer.children.length > 20) {
                    logContainer.removeChild(logContainer.lastChild);
                }

                // Auto-scroll to top
                logContainer.scrollTop = 0;
            }

            // Public methods for external API integration
            onNewBlock(blockData) {
                this.addLogEntry(`Block #${blockData.number} added to ${blockData.channel}`, 'success');
                this.metrics.totalTransactions += blockData.transactionCount;
                this.updateMetrics();
            }

            onSecurityAlert(alertData) {
                this.addLogEntry(`Security Alert: ${alertData.type}`, 'error');
                this.addSecurityAlert(alertData.message);
            }

            onDataAccess(accessData) {
                this.addLogEntry(`Data accessed by ${accessData.userId}`, 'info');
                this.metrics.dataAccesses++;
            }
        }

        // Initialize dashboard when page loads
        document.addEventListener('DOMContentLoaded', () => {
            window.dashboard = new MedicalBlockchainDashboard();
        });
    </script>
</body>

</html>